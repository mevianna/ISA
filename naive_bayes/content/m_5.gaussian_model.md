## Modelo Gaussiano

Até agora, trabalhamos exclusivamente com **variáveis discretas** — isto é, atributos que assumem valores específicos, contáveis e finitos. No caso dos modelos Multinomial e Bernoulli, lidamos com contagens de palavras (0, 1, 2, 3...) ou presenças binárias (0 ou 1).

> [!NOTE]
> **Variáveis Discretas vs Contínuas**
> 
> - **Variáveis Discretas**: Assumem valores específicos e contáveis. Exemplos: número de palavras, presença/ausência de características, número de cliques.
> - **Variáveis Contínuas**: Podem assumir qualquer valor dentro de um intervalo. Exemplos: altura, peso, temperatura, preço, velocidade.
>

### Quando Usar o Modelo Gaussiano

O **Gaussian Naive Bayes** é ideal quando seus atributos são **variáveis contínuas** que seguem (aproximadamente) uma distribuição normal dentro de cada classe. Exemplos típicos incluem:

- **Análise médica**: altura, peso, pressão arterial, níveis de colesterol
- **Análise financeira**: preços, taxas de juros, volumes de transação
- **Sensores**: temperatura, umidade, velocidade, aceleração

### Conceitos Fundamentais: Média e Variância

Antes de mergulharmos no modelo, precisamos relembrar dois conceitos estatísticos essenciais:

#### Média ($\mu$)
A **média** é o valor central de uma distribuição — o ponto onde os dados se "equilibram".

$$\mu = \frac{1}{n} \sum_{i=1}^{n} x_i$$

#### Variância ($\sigma^2$)
A **variância** mede o quão "espalhados" os dados estão em relação à média. Uma variância alta indica dados mais dispersos; uma variância baixa indica dados mais concentrados próximos à média.

$$\sigma^2 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \mu)^2$$

O **desvio padrão** ($\sigma$) é simplesmente a raiz quadrada da variância e tem a mesma unidade dos dados originais.

> [!NOTE]
> **Por que Média e Variância?**
> 
> A distribuição normal (gaussiana) é **completamente caracterizada** por apenas dois parâmetros: sua média e variância. Conhecendo esses valores, podemos calcular a probabilidade de qualquer ponto na distribuição.

### Distribuição Normal (Gaussiana)

A distribuição normal é uma das mais importantes na estatística. Sua função de densidade de probabilidade é:

$f(x|\mu, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}$

> [!IMPORTANT]
> **Função de Densidade vs Probabilidade**
> 
> Para variáveis contínuas, $f(x)$ **não é uma probabilidade** — é uma **densidade**. A probabilidade real é calculada integrando sobre um intervalo:
> 
> $P(a \leq X \leq b) = \int_a^b f(x|\mu, \sigma^2) dx$
> 
> No Naive Bayes, usamos $f(x)$ como uma medida de **verossimilhança relativa** para comparar quão "provável" é um valor em diferentes classes, mas não como probabilidade absoluta.

### Classificador Gaussian Naive Bayes

No Gaussian Naive Bayes, assumimos que cada atributo contínuo, dentro de cada classe, segue uma distribuição normal. O processo funciona assim:

1. **Treinamento**: Para cada atributo $X_i$ em cada classe $C$, calculamos:
   - Média: $\mu_{ic} = \frac{1}{N_c} \sum_{j \in C} x_{ij}$
   - Variância: $\sigma_{ic}^2 = \frac{1}{N_c} \sum_{j \in C} (x_{ij} - \mu_{ic})^2$

2. **Classificação**: Usamos a fórmula padrão do Naive Bayes:

$\hat{C} = \arg\max_C \left[ \log P(C) + \sum_{i=1}^{n} \log f(X_i|C) \right]$

Onde $f(X_i|C)$ é a função de densidade normal (não probabilidade!):

$f(X_i|C) = \frac{1}{\sqrt{2\pi\sigma_{ic}^2}} e^{-\frac{(x_i-\mu_{ic})^2}{2\sigma_{ic}^2}}$

### Exemplo Prático: Classificação de Risco Cardíaco

### 1. O Problema

Vamos classificar pacientes em `Baixo Risco` ou `Alto Risco` para complicações cardíacas com base em dois exames de rotina:

* `Colesterol LDL (mg/dL)`
* `Pressão Arterial Sistólica (mmHg)`

### 2. Perfil das Classes (Treinamento)

Com base em dados históricos, o modelo aprendeu os seguintes perfis (parâmetros) para cada classe:

**Classe `Baixo Risco`**
* **Colesterol LDL**: Perfil saudável, com média $\mu = 100 \text{ mg/dL}$ e desvio padrão $\sigma = 15$.
* **Pressão Arterial**: Perfil saudável e, crucialmente, **muito consistente**. A média é $\mu = 115 \text{ mmHg}$ com desvio padrão $\sigma = 5$.

**Classe `Alto Risco`**
* **Colesterol LDL**: Média elevada de $\mu = 160 \text{ mg/dL}$ e desvio padrão $\sigma = 30$
* **Pressão Arterial**: Média elevada de $\mu = 145 \text{ mmHg}$ e desvio padrão $\sigma = 10$.

### 3. O Paciente em Análise

Um novo paciente chega com os seguintes resultados:

* **Colesterol LDL**: 150 mg/dL
* **Pressão Arterial**: 130 mmHg

### 4. Análise Gráfica e Cálculo da Verossimilhança

Abaixo estão os gráficos das quatro distribuições, com um "X" preto marcando onde os dados do nosso paciente se encaixam.

![Gráficos das distribuições de Risco Cardíaco](.\figures\risco_cardiaco_distribuicoes.png)

Vamos analisar os números por trás dos gráficos, calculando a verossimilhança (a altura da curva no ponto do paciente) para cada caso.

#### Cálculos Detalhados

* **Para a classe `Baixo Risco`**:
    * $f(\text{colesterol}=150 | \text{Baixo Risco}) \approx 0.000103$
    * $f(\text{pressão}=130 | \text{Baixo Risco}) \approx 0.000886$
    > **Análise Chave**: Note como a verossimilhança da pressão é baixíssima. Como a curva de `Baixo Risco` para pressão é muito "estreita" (baixa variância), o valor 130 está a 3 desvios-padrão de distância da média de 115, tornando-o um evento extremamente raro e "estatisticamente incompatível" com este grupo.

* **Para a classe `Alto Risco`**:
    * $f(\text{colesterol}=150 | \text{Alto Risco}) \approx 0.012579$
    * $f(\text{pressão}=130 | \text{Alto Risco}) \approx 0.012952$
    > **Análise Chave**: Ambos os valores são muito plausíveis para a classe `Alto Risco`. Estão próximos das médias e dentro de curvas de distribuição mais "flexíveis" (maior variância), resultando em verossimilhanças muito maiores.

#### Scores Finais

Usando a fórmula do Naive Bayes em escala logarítmica e assumindo priors iguais ($P(\text{Baixo Risco}) = P(\text{Alto Risco}) = 0.5$):

* **Score (Baixo Risco)**: $\log(0.5) + \log(0.000103) + \log(0.000886) \approx \mathbf{-16.90}$
* **Score (Alto Risco)**: $\log(0.5) + \log(0.012579) + \log(0.012952) \approx \mathbf{-9.42}$

### 5. Conclusão

O score para **Alto Risco (-9.42)** é significativamente maior (menos negativo) que o de Baixo Risco (-16.90).



