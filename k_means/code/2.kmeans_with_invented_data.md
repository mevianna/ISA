# English Version

# Portuguese Version

Para um melhor entendimento do funcionamento do algoritmo K-Means, é interessante visualizá-lo operando com dados simulados. Essa abordagem permite observar de forma mais clara como o algoritmo identifica e forma bons agrupamentos (clusters).
Recomenda-se a leitura prévia do arquivo [1.kmeans_with_iris_dataset.md](https://github.com/mevianna/ISA/tree/k_means/k_means/code/1.kmeans_with_iris_dataset.md.md), pois este documento se apresenta praticamente o mesmo código do primeiro, explicando apenas as principais diferenças.

## Código

### Importação de bibliotecas

Para executar o K-Means com dados simulados, é necessário as seguintes bibliotecas:

```python
from sklearn.datasets import make_blobs
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score
import matplotlib.pyplot as plt
```
A principal diferença em relação ao exemplo com o dataset Iris está na linha ```from sklearn.datasets import make_blobs```. Nessa linha, é importada a função make_blobs da biblioteca scikit-learn, utilizada para gerar dados artificiais agrupados. Essa função facilita a criação de conjuntos de dados com distribuição definida, ideais para testes e visualização de algoritmos de agrupamento.

### Criação dos dados simulados:

Para criar o conjunto de dados simulados, executa-se a seguinte instrução:

```python
X, _ = make_blobs(n_samples=300, centers=3, cluster_std=0.5, random_state=42)
```

Nela, utiliza-se a função ```make_blobs``` para criar os dados simulados. Os argumentos dessa função são:
* ```n_samples=300```: número de pontos gerados (nesse caso, 300);
* ```centers=3```: número de centros (grupos), que é 3;
* ```cluster_std=1.0```: desvio padrão de dos pontos em torno dos centróides que estão associados (quanto maior, mais espalhados);
* ```random_state=42```: define a semente para geração aleatória, garantindo que os dados sejam sempre os mesmos quando rodar o código (reprodutibilidade).

Enquanto o retorno da função são dois valores:
* ```X```: as coordenadas dos pontos gerados, geralmente um array NumPy, por padrão, em duas dimensões;
* ```_```: os rótulos verdadeiros de cada ponto, que não serão utilizados, por isso atribuido a _ para serem ignorados.

### Plotagem do gráfico com dados simulados:

Para visualizar os dados gerados, podemos executar o seguinte código:

```python
plt.figure(figsize=(8, 5))
plt.scatter(X[:, 0], X[:, 1], c='hotpink', s=50)
plt.title("Clusters com K-Means (dados simulados)")
plt.xlabel("Componente 1")
plt.ylabel("Componente 2")
plt.grid(True)
plt.show()
```

Esse trecho cria um gráfico de dispersão, semelhante aos já utilizados anteriormente, mostrando os pontos simulados no espaço bidimensional.

<div align="center">
<img src= "..\img\dataset2_without_clusters.png" alt="Plotagem dos dados simulados" width="400">
</div>

### Execução do K-Means:

Após a criação dos dados simulados, o próximo passo é aplicar o algoritmo K-Means para realizar o agrupamento. Isso pode ser feito com o seguinte trecho de código:

```python
kmeans = KMeans(n_clusters=3, random_state=42)
labels = kmeans.fit_predict(X)
```

Esse código segue a mesma lógica utilizada em exemplos anteriores:
* ```KMeans(n_clusters=3)```: instancia o algoritmo K-Means, definindo que queremos formar 3 clusters;
* ```random_state=42```: garante reprodutibilidade dos resultados;
* ```fit_predict(X)```: ajusta o modelo aos dados e retorna os rótulos (labels) correspondentes ao cluster de cada ponto.Esses rótulos serão utilizados para colorir os dados de acordo com o agrupamento ao longo das visualizações.

### Plotagem do gráfico com K-Means:

Tendo realizado a execução do K-Means, é possível visualizar os agrupamentos formados com:

```python
plt.figure(figsize=(8, 5))
plt.scatter(X[:, 0], X[:, 1], c=labels, cmap='spring', s=50)
plt.title("Clusters com K-Means (dados simulados)")
plt.xlabel("Componente 1")
plt.ylabel("Componente 2")
plt.grid(True)
plt.show()
```

Assim, o gráfico formado é:
<div align="center">
<img src= "..\img\dataset2_without_clusters.png" alt="Plotagem dos agrupamentos para dados simulados" width="400">
</div>

### Métricas de validação:
